<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metrics</title>
    <link rel="icon" type="image/x-icon" href="/public/images/favicon.ico">
    <link rel="stylesheet" href="/public/css/metrics.css">
    <link rel="stylesheet" href="/public/css/common.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <header>
      <a href="/"><img src="/public/images/icons8-link-100.png" style="text-align: left;" /></a>
      <nav>
        <ul>
          <li><a href="/public/index.html">Home</a></li>
          <li style="text-decoration: underline;"><a href="/public/metrics.html">Metrics</a></li>
          <li><a href="/public/about.html">About</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <div id="wrapper">
        <h1>Link metrics</h1>
        <p>over the last 7 days</p>
        <form id="form" action="">
          <div id="shortLink">
            <p>makemeshort.buzz/</p>
            <input id="shortLinkInput" type="text" value="<%= shortUrl %>" />
            <button id="smallSubmit" type="submit"><img src="/public/images/search.svg" /></button>
          </div>
          <p id="shortLinkError"></p>
        </form>
        <p><b>redirects to:</b>
          <%= originalUrl %>
        </p>

        <div id="all-columns">

          <div id="column1">
            <br />
            <%- graphImage %>
          </div>

          <div id="column2">
            <p><b>total clicks:</b>
              <%= clicks %>
            </p>
            <p><b>unique visitors:</b>
              <%= uniqueVisitors %>
            </p>
            <br />
            <p><b>locations:</b></p>
            <% if (locations.length===0) { %>
              <p>no data</p>
              <% } else { %>
                <% for (let i=0; i < locations.length; i++) { %>
                  <p>
                    <%= Math.round(locations[i].percent * 100) %>% from <%= locations[i].region %>, <%=
                          locations[i].country %>
                  </p>
                  <% } %>
                    <% } %>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <a href="https://github.com/wheelercj/COMP583-G6/tree/main/public/privacy-policy.md">Privacy Policy</a> |
      <a target="_blank" href="https://icons8.com/icon/113527/link">Link</a> icon by <a target="_blank"
        href="https://icons8.com">Icons8</a>
    </footer>

  </body>

  <script src="/public/js/validators.js"></script>
  <script src="/public/js/metrics.js"></script>

</html>
